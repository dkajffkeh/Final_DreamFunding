<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="orderMapper">

	<resultMap id="projectResultSet" type="ProjectInsert">
		<result column="project_no" property="projectNo"/>
		<result column="project_title" property="projectTitle"/>
		<result column="project_close_dt" property="projectEndDate"/>	
	</resultMap>
	
	<resultMap id="shippingResultSet" type="Shipping">
		<result column="shipping_no" property="shippingNo"/>
		<result column="member_no" property="memberNo"/>
		<result column="shipping_zipcode" property="shippingZipcode"/>
		<result column="shpping_d_addr" property="shippingDAddr"/>
		<result column="shipping_s_addr" property="shippingSAddr"/>
		<result column="receiever_name" property="receieverName"/>
		<result column="receiever_phone" property="receieverPhone"/>
		<result column="shipping_basic" property="shippingBasic"/>
	</resultMap>

	<resultMap id="memberPurchaseResultSet" type="MemberPurchase">
		<result column="purchase_no" property="purchaseNo"/>
		<result column="member_no" property="memberNo"/>
		<result column="purchase_c_number" property="purchaseCNumber"/>
		<result column="purchase_v_year" property="purchaseVYear"/>
		<result column="purchase_v_month" property="purchaseVMonth"/>
		<result column="purchase_c_pwd" property="purchaseCPwd"/>
		<result column="purchase_c_date" property="purchaseCDate"/>
		<result column="purchase_bkey" property="purchaseBKey"/>
		<result column="purchase_email" property="purchaseEmail"/>
		<result column="purchase_basic" property="purchaseBasic"/>		
	</resultMap>
	
	<resultMap type="Member" id="memberResultSet">
	  	<result column="member_no" property="memNo"/>
	  	<result column="member_email" property="email"/>
	  	<result column="member_pwd" property="memNick"/>
	  	<result column="member_name" property="memName"/>
	  	<result column="member_phone" property="phone"/>
	  	<result column="member_createdate" property="memCreate"/>
	  	<result column="member_gender" property="gender"/>
	  	<result column="member_pf_path" property="memPfPath"/>
	  	<result column="member_systemname" property="memSystemname"/>
	  	<result column="member_status" property="memStatus"/>
	  	<result column="member_link" property="memLink"/>
	  	<result column="refres_token" property="refresToken"/>
	  	<result column="access_token" property="accessToken"/>
	  	<result column="status" property="status"/>
	  </resultMap>
	
	
	
	<select id="selectProject" 
			parameterType="_int" 
			resultMap="projectResultSet">
		select
		       project_title
		     , project_no
		     , project_close_dt
		  from project
		 where project_no = #{pno}
	</select>
	
	<select id="selectShipping"
			parameterType="_int"
			resultMap="shippingResultSet">
		select *
		  from shippping
		 where member_no = #{mno}		
	</select>
	
	<select id="selectMemberPurchaseList"
			parameterType="_int"
			resultMap="memberPurchaseResultSet">
			select 
			       purchase_c_number
			     , purchase_v_year
			     , purchase_v_month
			     , purchase_c_pwd
			     , purchase_c_date
			     , purchase_bkey
			     , purchase_email
			     , purchase_basic
			  from member_purchase
			 where member_no = #{mno}
	</select>
	
	<select id="selectMember"
			parameterType="_int"
			resultMap="memberResultSet">
		select *
		  from member
		 where member_no = #{mno}
	</select>
	
	<insert id="insertPurchaseInsert" parameterType="PurchaseInfo">
		insert 
		  into purchaseInfo
		  (
		     purinfo_no
		   , member_no
		   , re_no
		   , reward_amount
		   , reward_plus
		   , purinfo_status
		   , delivery_status
		   , shipping_zipcode
		   , shipping_s_addr
		   , shipping_d_addr
		   , receiever_name
		   , reveiever_phone
		   , purinfo_req
		   , purchase_c_number
		   , purchase_v_year
		   , purchase_v_month
		   , purchase_c_pwd
		   , purchase_c_date
		   , purchase_bkey
		   , purchase_email
		  )
		  values
		  (
		     seq_odno.nextval
		   , #{memberNo}
		   , #{reNo}
		   , #{rewardAmount}
		   , #{rewardPlus}
		   , "Y"
		   , #{shippingZipecode}
		   , #{shippingSAddr}
		   , #{shippingDAddr}
		   , #{receieverName}
		   , #{receieverPhone}
		   , #{purinfoReq}
		   , #{purchaseCNumber}
		   , #{purchaseVYear}
		   , #{purchaseVMonth}
		   , #{purchaseCPwd}
		   , #{purchaseCDate}
		   , #{purchaseBkey}
		   , "" 
		  )
	</insert>
  
</mapper>
